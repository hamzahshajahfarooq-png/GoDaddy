<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Search Results — Domainly</title>
<style>
  :root{--bg:#071327;--card:#071a2b;--muted:#94a3b8;--accent:#7c3aed}
  body{margin:0;font-family:Inter, system-ui, -apple-system, Roboto, Arial;color:#e7f0ff;background:linear-gradient(180deg,#041021, #071827);-webkit-font-smoothing:antialiased}
  .wrap{max-width:1000px;margin:28px auto;padding:18px}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
  .breadcrumb{color:var(--muted);font-size:13px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
  .result{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px;border-radius:10px;background:rgba(255,255,255,0.015);margin-top:10px}
  .domain-name{font-weight:800;font-size:18px}
  .badge{padding:8px 10px;border-radius:8px;font-weight:700}
  .available{background:linear-gradient(90deg,#10b981,#34d399);color:#051521}
  .taken{background:linear-gradient(90deg,#ef4444,#f97316);color:white}
  button{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .add{background:linear-gradient(90deg,var(--accent),#06b6d4);color:#051021}
  .smallmuted{color:var(--muted);font-size:13px}
  .actions{display:flex;gap:8px;align-items:center}
  @media (max-width:720px){
    .result{flex-direction:column;align-items:flex-start}
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <div style="font-weight:800;font-size:20px;cursor:pointer" onclick="goTo('index.html')">Domainly</div>
      <div class="breadcrumb">Search results</div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <div class="smallmuted">Cart: <span id="cartCount">0</span></div>
      <button onclick="goTo('checkout.html')" style="background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px">Checkout</button>
    </div>
  </header>

  <div class="card" id="resultsCard">
    <div id="queryHeading" style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="font-size:16px;font-weight:800" id="searchedDomain">Searching...</div>
        <div class="smallmuted" id="subText">Checking availability...</div>
      </div>
      <div id="actionBlock" style="display:flex;gap:8px;align-items:center"></div>
    </div>

    <div id="otherSuggestions" style="margin-top:18px"></div>

    <hr style="margin:18px 0;border:none;height:1px;background:rgba(255,255,255,0.03)" />

    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <div style="flex:1;min-width:220px">
        <h4 style="margin:0 0 8px">Domain details</h4>
        <div class="smallmuted" id="details">—</div>
      </div>

      <div style="width:260px">
        <h4 style="margin:0 0 8px">Related extensions</h4>
        <div id="extensions"></div>
      </div>
    </div>
  </div>
</div>

<script>
  // helpers
  function goTo(url){ window.location.href = url; }
  function qs(key){ const params=new URLSearchParams(location.search); return params.get(key); }

  // simple deterministic availability function using char codes (mock)
  function isAvailable(domain){
    // if domain exists in registered list -> not available
    const regs = JSON.parse(localStorage.getItem('domainly_registered')||'[]');
    if(regs.some(r=>r.domain.toLowerCase()===domain.toLowerCase())) return false;
    // deterministic pseudo-random: sum char codes mod 3 -> if 0 treat as taken to simulate realism
    let sum=0; for(let i=0;i<domain.length;i++) sum+=domain.charCodeAt(i);
    return (sum % 3) !== 0;
  }

  // render
  const domainParam = decodeURIComponent(qs('domain')||qs('example')||'');
  const domain = domainParam || 'yourbrand.com';
  document.getElementById('searchedDomain').textContent = domain;
  document.getElementById('subText').textContent = 'Instant availability check — mock results';

  // cart
  function updateCartCount(){ document.getElementById('cartCount').textContent = JSON.parse(localStorage.getItem('domainly_cart')||'[]').length; }
  updateCartCount();

  // main result
  const available = isAvailable(domain);
  const actionBlock = document.getElementById('actionBlock');
  actionBlock.innerHTML = available
    ? '<div class="badge available">Available</div><div class="actions"><button class="add" onclick="addToCart(\\''+domain.replace(/'/g,"\\'")+'\\')">Add to Cart</button></div>'
    : '<div class="badge taken">Taken</div><div class="actions"><button onclick="suggestAlternatives()" style="background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px">Get alternatives</button></div>';

  // domain details
  document.getElementById('details').textContent = available ? 'Not registered. Secure it now and get protection options at checkout.' : 'This domain is already registered. You may check WHOIS or try other extensions.';

  // show related extensions
  const base = domain.split('.').slice(0,-1).join('.') || domain;
  const commonTlds = ['.com','.net','.org','.io','.co','.app','.tech'];
  const extContainer = document.getElementById('extensions');
  commonTlds.forEach(tld=>{
    const d = base + (tld.startsWith('.') ? tld : '.'+tld);
    const avail = isAvailable(d);
    const div = document.createElement('div');
    div.className='result';
    div.innerHTML = '<div><div class="domain-name">'+d+'</div><div class="smallmuted">'+(avail? 'Available':'Taken')+'</div></div><div style="display:flex;gap:8px;align-items:center">'+(avail?('<button class="add" onclick="addToCart(\\''+d.replace(/'/g,"\\'")+'\\')">Add</button>'):'<button onclick="viewWHOIS(\\''+d.replace(/'/g,"\\'")+'\\')">WHOIS</button>')+'</div>';
    extContainer.appendChild(div);
  });

  // alternatives suggestions
  function suggestAlternatives(){
    const suggestions = [
      domain.replace(/\.(\w+)$/,'-shop.$1'),
      'get-'+domain,
      domain.replace(/[^a-z0-9]/gi,'') + Math.floor(Math.random()*99)
    ];
    const place = document.getElementById('otherSuggestions');
    place.innerHTML = '<h4 style="margin:0">Suggested alternatives</h4>';
    suggestions.forEach(s=>{
      const row = document.createElement('div');
      row.className = 'result';
      row.innerHTML = '<div style="font-weight:700">'+s+'</div><div><button class="add" onclick="addToCart(\\''+s.replace(/'/g,"\\'")+'\\')">Add</button></div>';
      place.appendChild(row);
    });
  }

  function addToCart(domainToAdd){
    const cart = JSON.parse(localStorage.getItem('domainly_cart')||'[]');
    if(cart.find(c=>c.domain===domainToAdd)){ alert('This domain is already in cart.'); return; }
    cart.push({domain:domainToAdd,price:priceFor(domainToAdd)});
    localStorage.setItem('domainly_cart', JSON.stringify(cart));
    updateCartCount();
    alert(domainToAdd + ' added to cart.');
  }

  function viewWHOIS(d){
    alert('WHOIS feature is not functional in this demo. Domain: ' + d);
  }

  function priceFor(d){
    if(d.endsWith('.io')) return 39.99;
    if(d.endsWith('.co')) return 19.99;
    if(d.endsWith('.app')) return 14.99;
    return 12.99;
  }

  // write actionBlock content properly (escape handling)
  (function adaptActionBlock(){
    const ab = actionBlock;
    const availBadge = available ? '<div class="badge available">Available</div>' : '<div class="badge taken">Taken</div>';
    const btn = available ? '<button class="add" onclick="addToCart(\\''+domain.replace(/'/g,"\\'")+'\\')">Add to Cart</button>' : '<button onclick="suggestAlternatives()">Get alternatives</button>';
    ab.innerHTML = availBadge + '<div class="actions">'+btn+'</div>';
  })();
</script>
</body>
</html>
